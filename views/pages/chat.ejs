

<%
// Sample data for messages
const activeChat = {
    contact: contacts[0],
    messages: [
        { id: 1, sender: 'them', content: 'Hey, how are you?', time: '10:15 AM', status: 'read' },
        { id: 2, sender: 'me', content: 'I\'m good, thanks! Just working on a new project.', time: '10:17 AM', status: 'read' },
        { id: 3, sender: 'them', content: 'That sounds interesting! What kind of project?', time: '10:18 AM', status: 'read' },
        { id: 4, sender: 'me', content: 'It\'s a social media app with some unique features. I\'m really excited about it!', time: '10:20 AM', status: 'read' },
        { id: 5, sender: 'them', content: 'That sounds awesome! Can\'t wait to see it when it\'s done.', time: '10:22 AM', status: 'read' },
        { id: 6, sender: 'me', content: 'Thanks! I\'ll definitely share it with you once it\'s ready for testing.', time: '10:25 AM', status: 'delivered' },
        { id: 7, sender: 'them', content: 'Perfect! Let me know if you need any help with testing or feedback.', time: '10:26 AM', status: 'read' },
        { id: 8, sender: 'me', content: 'Will do! How\'s your day going?', time: '10:30 AM', status: 'sent' }
    ]
};
%>

<div class="h-[calc(100vh-4rem)] flex">
    <!-- Contacts List -->
    <div class="w-80 bg-white dark:bg-dark-800 border-r border-gray-200 dark:border-dark-700 flex flex-col">
        <!-- Search Bar -->
        <div class="p-4 border-b border-gray-200 dark:border-dark-700">
            <div class="relative">
                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                    <i class="fas fa-search text-gray-400"></i>
                </div>
                <input type="text" class="block w-full pl-10 pr-3 py-2 border border-gray-300 dark:border-dark-600 rounded-lg bg-gray-100 dark:bg-dark-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500 sm:text-sm" placeholder="Search messages...">
            </div>
        </div>

        <!-- Contacts -->
        <div class="flex-1 overflow-y-auto">
            <div class="p-2">
                <h3 class="text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider px-2 mb-2">Recent Chats</h3>

                <div class="space-y-1">
                    <% contacts.forEach((contact, index) => { %>
                        <a href="#" class="flex items-center p-2 rounded-lg <%= index === 0 ? 'bg-primary-50 dark:bg-primary-900/20' : 'hover:bg-gray-100 dark:hover:bg-dark-700' %>">
                            <div class="relative">
                                <img src="<%= contact.avatar %>" alt="<%= contact.name %>" class="w-12 h-12 rounded-full object-cover border-2 <%= index === 0 ? 'border-primary-300' : 'border-gray-200 dark:border-dark-600' %>">
                                <% if (contact.online) { %>
                                    <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-dark-800"></div>
                                <% } %>
                            </div>
                            <div class="ml-3 flex-1">
                                <div class="flex items-center justify-between">
                                    <h4 class="font-medium text-dark-900 dark:text-white"><%= contact.name %></h4>
                                    <span class="text-xs text-gray-500 dark:text-gray-400"><%= index === 0 ? 'Now' : index === 1 ? '5m' : index === 2 ? '2h' : '1d' %></span>
                                </div>
                                <p class="text-sm text-gray-500 dark:text-gray-400 truncate"><%= contact.lastMessage %></p>
                            </div>
                        </a>
                    <% }); %>
                </div>
            </div>
        </div>

        <!-- New Message Button -->
        <div class="p-4 border-t border-gray-200 dark:border-dark-700">
            <button class="w-full bg-gradient-to-r from-primary-500 to-secondary-500 hover:from-primary-600 hover:to-secondary-600 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center space-x-2 transition duration-200">
                <i class="fas fa-pen-to-square"></i>
                <span>New Message</span>
            </button>
        </div>
    </div>

    <!-- Chat Area -->
    <div class="flex-1 flex flex-col bg-gray-50 dark:bg-dark-900">
        <!-- Chat Header -->
        <div class="bg-white dark:bg-dark-800 border-b border-gray-200 dark:border-dark-700 p-4 flex items-center justify-between">
            <div class="flex items-center space-x-3">
                <div class="relative">
                    <img src="<%= activeChat.contact.avatar %>" alt="<%= activeChat.contact.name %>" class="w-10 h-10 rounded-full object-cover border-2 border-primary-300">
                    <% if (activeChat.contact.online) { %>
                        <div class="absolute bottom-0 right-0 w-3 h-3 bg-green-500 rounded-full border-2 border-white dark:border-dark-800"></div>
                    <% } %>
                </div>
                <div>
                    <h3 class="font-semibold text-dark-900 dark:text-white"><%= activeChat.contact.name %></h3>
                    <p class="text-xs text-gray-500 dark:text-gray-400"><%= activeChat.contact.online ? 'Online' : 'Offline' %></p>
                </div>
            </div>

            <div class="flex items-center space-x-3">
                <button class="text-dark-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700">
                    <i class="fas fa-phone"></i>
                </button>
                <button class="text-dark-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700">
                    <i class="fas fa-video"></i>
                </button>
                <button class="text-dark-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>

        <!-- Messages -->
        <div class="flex-1 overflow-y-auto p-4 space-y-4">
            <% activeChat.messages.forEach(message => { %>
                <div class="flex <%= message.sender === 'me' ? 'justify-end' : '' %>">
                    <div class="max-w-[70%]">
                        <% if (message.sender === 'them') { %>
                            <div class="flex items-end space-x-2">
                                <img src="<%= activeChat.contact.avatar %>" alt="<%= activeChat.contact.name %>" class="w-8 h-8 rounded-full object-cover border-2 border-primary-300 flex-shrink-0">
                                <div class="bg-white dark:bg-dark-800 rounded-2xl rounded-bl-none px-4 py-2 shadow-sm">
                                    <p class="text-dark-800 dark:text-gray-200"><%= message.content %></p>
                                </div>
                            </div>
                        <% } else { %>
                            <div class="bg-gradient-to-r from-primary-500 to-secondary-500 rounded-2xl rounded-br-none px-4 py-2 shadow-sm">
                                <p class="text-white"><%= message.content %></p>
                            </div>
                        <% } %>
                        <div class="flex items-center mt-1 <%= message.sender === 'me' ? 'justify-end' : 'ml-10' %>">
                            <span class="text-xs text-gray-500 dark:text-gray-400"><%= message.time %></span>
                            <% if (message.sender === 'me') { %>
                                <span class="ml-2">
                                    <% if (message.status === 'sent') { %>
                                        <i class="fas fa-check text-xs text-gray-400"></i>
                                    <% } else if (message.status === 'delivered') { %>
                                        <i class="fas fa-check-double text-xs text-gray-400"></i>
                                    <% } else if (message.status === 'read') { %>
                                        <i class="fas fa-check-double text-xs text-primary-500"></i>
                                    <% } %>
                                </span>
                            <% } %>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>

        <!-- Message Input -->
        <div class="bg-white dark:bg-dark-800 border-t border-gray-200 dark:border-dark-700 p-4">
            <div class="flex items-center space-x-3">
                <button class="text-dark-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700">
                    <i class="far fa-smile"></i>
                </button>
                <button class="text-dark-600 dark:text-gray-300 hover:text-primary-500 dark:hover:text-primary-400 p-2 rounded-full hover:bg-gray-100 dark:hover:bg-dark-700">
                    <i class="fas fa-paperclip"></i>
                </button>
                <div class="flex-1 relative">
                    <input type="text" class="w-full py-2 px-4 bg-gray-100 dark:bg-dark-700 border border-gray-300 dark:border-dark-600 rounded-full focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500" placeholder="Type a message...">
                </div>
                <button class="text-white bg-gradient-to-r from-primary-500 to-secondary-500 hover:from-primary-600 hover:to-secondary-600 p-3 rounded-full flex items-center justify-center transition duration-200">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
</div>
